<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estrat√©gia Penny Product: Imers√£o & ROI</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet" />

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'sans-serif'] },
          colors: {
            brand: {
              dark: '#312e81',
              primary: '#4338ca',
              secondary: '#0d9488',
              accent: '#f59e0b',
              light: '#e0e7ff',
              bg: '#f8fafc',
            },
          },
        },
      },
    };
  </script>

  <style>
    .chart-container {
      position: relative;
      width: 100%;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      height: 350px;
      max-height: 450px;
    }
    @media (max-width: 640px) {
      .chart-container { height: 280px; }
    }

    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(226, 232, 240, 0.8);
    }
    .gradient-text {
      background: linear-gradient(135deg, #312e81 0%, #0d9488 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .step-connector::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      width: 2px;
      height: 24px;
      background-color: #cbd5e1;
      transform: translateX(-50%);
      z-index: 0;
    }
    .last-step::after { display: none; }
    @media (min-width: 768px) {
      .step-connector::after {
        top: 50%;
        left: 100%;
        width: 24px;
        height: 2px;
        transform: translateY(-50%);
      }
    }

    /* Subtexto KPI */
    .kpi-sub { font-size: 12px; color: #64748b; margin-top: 6px; line-height: 1.3; }

    /* Remove spinners em inputs number */
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[type=number] { -moz-appearance: textfield; }

    /* KPI layout fixes (resolve quebra/√≥rf√£os) */
    .kpi-card { min-width: 0; }
    .kpi-title {
      font-size: 12px;
      line-height: 1.2;
      letter-spacing: .08em;
      text-transform: uppercase;
      font-weight: 700;
      color: #64748b;
    }
    .kpi-value {
      font-variant-numeric: tabular-nums;
      letter-spacing: -0.02em;
      line-height: 1.05;
      word-break: break-word;
    }
  </style>
</head>

<body class="bg-brand-bg text-slate-800 antialiased selection:bg-brand-secondary selection:text-white">

  <!-- Header -->
  <header class="w-full bg-white shadow-sm border-b border-gray-100 py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-5xl mx-auto text-center">
      <span class="inline-block py-1 px-3 rounded-full bg-brand-light text-brand-primary text-xs font-bold tracking-wider uppercase mb-4">
        Estrat√©gia de Monetiza√ß√£o
      </span>
      <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight mb-4">
        <span class="gradient-text">Penny Product</span> na Imers√£o
      </h1>
      <p class="text-lg md:text-xl text-slate-500 max-w-3xl mx-auto">
        Transformando a p√°gina de obrigado em uma alavanca de qualifica√ß√£o, receita antecipada e escala estrutural.
      </p>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-16">

    <!-- PROBLEMA -->
    <section class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
      <div class="bg-white p-8 rounded-xl shadow-md border-l-8 border-brand-secondary">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">O Problema Atual</h2>
        <p class="text-gray-600 mb-4">
          Hoje, a imers√£o √© 100% gratuita com um CPL m√©dio de R$8.
          A convers√£o para o "Plano Full" depende exclusivamente de engajamento e nutri√ß√£o durante o evento.
        </p>
        <div class="bg-red-50 p-4 rounded-lg">
          <p class="font-semibold text-red-700">‚ùå Risco:</p>
          <p class="text-red-600 text-sm">
            Leads com baixo compromisso psicol√≥gico ("s√≥ mais um cadastro") diluem a taxa de convers√£o final.
          </p>
        </div>
      </div>

      <div class="bg-white p-8 rounded-xl shadow-md border-l-8 border-brand-primary">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">O Que Muda com o Penny</h2>
        <p class="text-gray-600 mb-4">
          A proposta n√£o √© ‚Äúvender barato‚Äù ‚Äî √© criar um <strong>micro-compromisso</strong> que
          segmenta inten√ß√£o, aumenta <strong>RPL</strong> e eleva o <strong>teto de escala</strong> do tr√°fego.
        </p>
        <div class="bg-emerald-50 p-4 rounded-lg">
          <p class="font-semibold text-emerald-700">‚úÖ Efeito esperado:</p>
          <p class="text-emerald-700 text-sm">
            Compradores do Penny convertem mais no Full + gera√ß√£o de caixa para abater custo e reduzir CAC l√≠quido.
          </p>
        </div>
      </div>
    </section>

    <!-- CONCEITO -->
    <section class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
      <div>
        <h2 class="text-3xl font-bold text-slate-900 mb-6 border-l-4 border-brand-secondary pl-4">
          O Que √© o Penny Product?
        </h2>
        <p class="text-slate-600 mb-4 leading-relaxed">
          √â uma <strong>camada estrat√©gica de qualifica√ß√£o</strong>. Oferta de baixo ticket (R$5 e/ou R$17) apresentada
          inicialmente (teste 1) na Thank You Page (TYP) da imers√£o gratuita.
        </p>
        <p class="text-slate-600 mb-6 leading-relaxed">
          Ao criar um micro-compromisso financeiro, identificamos leads com <strong>maior inten√ß√£o de compra</strong>
          para o produto principal, enquanto geramos caixa para abater custos operacionais.
        </p>

        <div class="grid grid-cols-2 gap-4">
          <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-100">
            <div class="text-brand-primary text-2xl font-bold mb-1">üîç</div>
            <h3 class="font-semibold text-slate-900">Filtro de Inten√ß√£o</h3>
            <p class="text-xs text-slate-500">Quem paga, engaja mais.</p>
          </div>
          <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-100">
            <div class="text-brand-secondary text-2xl font-bold mb-1">üí∞</div>
            <h3 class="font-semibold text-slate-900">Receita Antecipada</h3>
            <p class="text-xs text-slate-500">Cashflow imediato.</p>
          </div>
        </div>
      </div>

      <div class="bg-gradient-to-br from-brand-dark to-brand-primary rounded-2xl p-8 text-white shadow-xl relative overflow-hidden">
        <div class="absolute top-0 right-0 opacity-10 text-9xl font-black -mr-4 -mt-4">R$</div>
        <h3 class="text-2xl font-bold mb-6">Objetivos Centrais</h3>
        <ul class="space-y-4">
          <li class="flex items-start">
            <span class="flex-shrink-0 h-6 w-6 rounded-full bg-brand-accent flex items-center justify-center text-xs font-bold text-white mt-1 mr-3">1</span>
            <span><strong>Reduzir Risco:</strong> Diminuir a exposi√ß√£o financeira da opera√ß√£o e de tr√°fego.</span>
          </li>
          <li class="flex items-start">
            <span class="flex-shrink-0 h-6 w-6 rounded-full bg-brand-accent flex items-center justify-center text-xs font-bold text-white mt-1 mr-3">2</span>
            <span><strong>Validar Lead:</strong> O cart√£o de cr√©dito √© o melhor validador de interesse.</span>
          </li>
          <li class="flex items-start">
            <span class="flex-shrink-0 h-6 w-6 rounded-full bg-brand-accent flex items-center justify-center text-xs font-bold text-white mt-1 mr-3">3</span>
            <span><strong>Elevar o Teto:</strong> Aumentar o teto de gasto por lead sustent√°vel (CAC l√≠quido).</span>
          </li>
        </ul>
      </div>
    </section>

    <!-- HIST√ìRICO -->
    <section class="bg-slate-50 rounded-3xl p-8 md:p-12 border border-slate-200">
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-slate-900 mb-2">Hist√≥rico de Valida√ß√£o: Imers√£o Unlock</h2>
        <p class="text-slate-600">
          A imers√£o unlock foi um teste de acesso estendido ao conte√∫do. Um teste A/B realizado na imers√£o Agentes de IA (2025)
          mostra disposi√ß√£o de compra na TYP, mesmo com ticket acima do ‚Äúpenny‚Äù tradicional.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
        <div class="glass-card p-6 rounded-xl shadow-sm text-center transform transition hover:-translate-y-1">
          <div class="text-sm text-slate-500 font-medium uppercase tracking-wide mb-2">Ticket M√©dio</div>
          <div class="text-3xl font-bold text-brand-dark">R$ 79,90</div>
          <div class="text-xs text-green-600 font-semibold mt-1">Oferta Agentes IA</div>
        </div>

        <div class="glass-card p-6 rounded-xl shadow-sm text-center transform transition hover:-translate-y-1">
          <div class="text-sm text-slate-500 font-medium uppercase tracking-wide mb-2">Convers√£o TYP</div>
          <div class="text-3xl font-bold text-brand-secondary">1,9%</div>
          <div class="text-xs text-slate-400 mt-1">Imediata</div>
        </div>

        <div class="glass-card p-6 rounded-xl shadow-sm text-center transform transition hover:-translate-y-1">
          <div class="text-sm text-slate-500 font-medium uppercase tracking-wide mb-2">Compradores</div>
          <div class="text-3xl font-bold text-slate-800">79</div>
          <div class="text-xs text-slate-400 mt-1">Total de Vendas</div>
        </div>

        <div class="glass-card p-6 rounded-xl shadow-sm text-center transform transition hover:-translate-y-1">
          <div class="text-sm text-slate-500 font-medium uppercase tracking-wide mb-2">Perfil</div>
          <div class="text-3xl font-bold text-brand-accent">85%</div>
          <div class="text-xs text-slate-400 mt-1">N√£o eram alunos</div>
        </div>
      </div>
    </section>

    <!-- PAINEL EXECUTIVO -->
    <section class="bg-white p-8 rounded-2xl shadow-md border border-slate-100">
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-6 mb-8">
        <div>
          <h2 class="text-3xl font-bold text-slate-900 mb-2 border-l-4 border-brand-secondary pl-4">
            Resultado Esperado (L1/L2/L3 + Mix + Sensibilidade)
          </h2>
          <p class="text-slate-600 max-w-3xl">
            Painel vivo baseado nas premissas do modelo. Ajuste taxas e veja impacto em:
            <strong>monetiza√ß√£o imediata (L1)</strong>, <strong>qualifica√ß√£o (L2)</strong> e <strong>teto de escala (L3)</strong>.
          </p>
        </div>

        <div class="text-xs text-slate-500 bg-slate-50 border border-slate-200 rounded-xl p-4">
          <div class="font-semibold text-slate-700 mb-1">Leitura r√°pida</div>
          <div>‚Ä¢ <strong>RPL</strong> = Receita Total / Inscritos</div>
          <div>‚Ä¢ <strong>CAC l√≠quido</strong> = CPL - (Receita Penny / Inscritos)</div>
          <div>‚Ä¢ <strong>Teto CPA</strong> ‚âà RPL - (Custo fixo/lead)</div>
        </div>
      </div>

      <!-- Inputs -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
        <div class="bg-slate-50 border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-600 mb-2">Base (inscritos)</div>
          <input id="inpBase" type="number" value="41000" class="w-full rounded-lg border border-slate-300 p-2 text-sm" />
          <div class="text-xs text-slate-500 mt-2">Ex: 41.000 (50% da base total)</div>
        </div>

        <div class="bg-slate-50 border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-600 mb-2">CPL m√©dio (R$)</div>
          <input id="inpCPL" type="number" step="0.01" value="8" class="w-full rounded-lg border border-slate-300 p-2 text-sm" />
          <div class="text-xs text-slate-500 mt-2">J√° inclui custo de m√≠dia por lead</div>
        </div>

        <div class="bg-slate-50 border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-600 mb-2">Custo fixo (R$)</div>
          <input id="inpFixed" type="number" value="25000" class="w-full rounded-lg border border-slate-300 p-2 text-sm" />
          <div class="text-xs text-slate-500 mt-2">Break-even estrutural</div>
        </div>

        <div class="bg-slate-50 border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-600 mb-2">Ticket Plano Full (R$)</div>
          <input id="inpFullTicket" type="number" value="1200" class="w-full rounded-lg border border-slate-300 p-2 text-sm" />
          <div class="text-xs text-slate-500 mt-2">TM usado no modelo</div>
        </div>

        <div class="bg-slate-50 border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-600 mb-2">% Convers√£o Penny (total)</div>
          <input id="inpPennyConv" type="number" step="0.01" value="2.44" class="w-full rounded-lg border border-slate-300 p-2 text-sm" />
          <div class="text-xs text-slate-500 mt-2">Ex: 2,44%</div>
        </div>

        <div class="bg-slate-50 border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-600 mb-2">Split: % escolhe R$5</div>
          <input id="inpSplit5" type="number" step="1" value="70" class="w-full rounded-lg border border-slate-300 p-2 text-sm" />
          <div class="text-xs text-slate-500 mt-2">R$17 = 100 - R$5</div>
        </div>

        <div class="bg-slate-50 border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-600 mb-2">Conv. Full (controle)</div>
          <input id="inpFullCtrl" type="number" step="0.01" value="0.80" class="w-full rounded-lg border border-slate-300 p-2 text-sm" />
          <div class="text-xs text-slate-500 mt-2">Sem penny</div>
        </div>

        <div class="bg-slate-50 border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-600 mb-2">Uplift comprador ‚Üí Full (x)</div>
          <input id="inpBuyerUplift" type="number" min="1" step="0.1" value="3.8" class="w-full rounded-lg border border-slate-300 p-2 text-sm" />
          <div class="text-xs text-slate-500 mt-2">Ex: 3,8√ó mais que o controle</div>
        </div>
      </div>

      <!-- Guardrails -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-10">
        <div class="bg-white border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-700 mb-2">Guardrail (Downside)</div>
          <div class="text-xs text-slate-600">
            O modelo assume que o Penny n√£o reduz a convers√£o do Full do grupo controle (apenas cria um cluster com inten√ß√£o maior).
            Se houver canibaliza√ß√£o, o heatmap mostra onde a margem fica apertada.
          </div>
        </div>
        <div class="bg-white border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-700 mb-2">CPL vs ‚Äúcusto total m√≠dia‚Äù</div>
          <div class="text-xs text-slate-600">
            <strong>CPL j√° inclui m√≠dia</strong>. Voc√™ s√≥ ‚Äúduplica‚Äù custo se somar um or√ßamento de m√≠dia separado
            al√©m do CPL. Use or√ßamento s√≥ para estimar volume: <em>Leads = Budget / CPL</em>.
          </div>
        </div>
        <div class="bg-white border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="text-xs font-semibold text-slate-700 mb-2">O que importa</div>
          <div class="text-xs text-slate-600">
            <strong>L1:</strong> Receita Penny ‚Ä¢ <strong>L2:</strong> Uplift comprador no Full ‚Ä¢ <strong>L3:</strong> Teto CPA e CAC l√≠quido.
          </div>
        </div>
      </div>

      <!-- KPI Cards (corrigido: grid sem √≥rf√£o + t√≠tulos pequenos) -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6">
        <div class="glass-card kpi-card p-6 rounded-xl shadow-sm xl:col-span-2">
          <div class="kpi-title">Receita total (penny + full)</div>
          <div id="kpiTotalRevenue" class="kpi-value text-3xl md:text-4xl font-extrabold text-slate-900 mt-2">‚Äî</div>
          <div id="kpiTotalRevenueNote" class="kpi-sub">‚Äî</div>
        </div>

        <div class="glass-card kpi-card p-6 rounded-xl shadow-sm">
          <div class="kpi-title">RPL</div>
          <div id="kpiRPL" class="kpi-value text-3xl md:text-4xl font-extrabold text-slate-900 mt-2">‚Äî</div>
          <div id="kpiRPLNote" class="kpi-sub">‚Äî</div>
        </div>

        <div class="glass-card kpi-card p-6 rounded-xl shadow-sm">
          <div class="kpi-title">CAC l√≠quido (proxy)</div>
          <div id="kpiNetCAC" class="kpi-value text-3xl md:text-4xl font-extrabold text-slate-900 mt-2">‚Äî</div>
          <div id="kpiNetCACNote" class="kpi-sub">‚Äî</div>
        </div>

        <div class="glass-card kpi-card p-6 rounded-xl shadow-sm">
          <div class="kpi-title">Incremento vs atual</div>
          <div id="kpiIncrement" class="kpi-value text-3xl md:text-4xl font-extrabold text-slate-900 mt-2">‚Äî</div>
          <div id="kpiIncrementNote" class="kpi-sub">‚Äî</div>
        </div>

        <div class="glass-card kpi-card p-6 rounded-xl shadow-sm">
          <div class="kpi-title">Teto de escala (CPA m√°x proxy)</div>
          <div id="kpiCPAMax" class="kpi-value text-3xl md:text-4xl font-extrabold text-slate-900 mt-2">‚Äî</div>
          <div id="kpiCPAMaxNote" class="kpi-sub">‚Äî</div>
        </div>
      </div>

      <!-- Charts -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mt-10">
        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 lg:col-span-1 min-w-0">
          <h3 class="font-bold text-center mb-4 text-slate-700">Mix de Compradores (R$5 vs R$17)</h3>
          <div class="chart-container" style="height: 260px;">
            <canvas id="mixBuyersChart"></canvas>
          </div>
          <div class="text-xs text-slate-500 mt-4">
            Distribui√ß√£o do penny (quem paga R$5 vs R$17).
          </div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 lg:col-span-2 min-w-0">
          <h3 class="font-bold text-center mb-4 text-slate-700">Receita por Fonte (Penny vs Full)</h3>
          <div class="chart-container">
            <canvas id="revenueSplitChart"></canvas>
          </div>
          <div class="text-xs text-slate-500 mt-4">
            O Penny importa pelo efeito de qualifica√ß√£o: o grosso vem do Full, mas o Penny aumenta RPL e o teto de escala.
          </div>
        </div>
      </div>

      <!-- Resumo executivo -->
      <div class="mt-10 bg-slate-50 border border-slate-200 rounded-2xl p-6">
        <h3 class="text-sm font-bold text-slate-800 mb-3">Resumo executivo (L1 / L2 / L3)</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-slate-700">
          <div class="bg-white border border-slate-200 rounded-xl p-4 min-w-0">
            <div class="font-semibold">L1 ‚Äî Monetiza√ß√£o imediata</div>
            <div class="text-xs text-slate-500 mt-1">Receita Penny / Lead reduz CAC l√≠quido</div>
            <div id="execL1" class="text-sm font-bold mt-2">‚Äî</div>
          </div>
          <div class="bg-white border border-slate-200 rounded-xl p-4 min-w-0">
            <div class="font-semibold">L2 ‚Äî Qualifica√ß√£o</div>
            <div class="text-xs text-slate-500 mt-1">Compradores convertem mais no Full</div>
            <div id="execL2" class="text-sm font-bold mt-2">‚Äî</div>
          </div>
          <div class="bg-white border border-slate-200 rounded-xl p-4 min-w-0">
            <div class="font-semibold">L3 ‚Äî Teto de escala</div>
            <div class="text-xs text-slate-500 mt-1">RPL maior sustenta CPA maior</div>
            <div id="execL3" class="text-sm font-bold mt-2">‚Äî</div>
          </div>
        </div>
      </div>
    </section>

    <!-- SENSIBILIDADE (HEATMAP) -->
    <section class="bg-slate-50 rounded-3xl p-8 md:p-12 border border-slate-200">
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-slate-900 mb-2">Sensibilidade: % Penny x Convers√£o Full (controle)</h2>
        <p class="text-slate-600 max-w-4xl">
          Heatmap do <strong>RPL</strong> e da <strong>Margem/Lead</strong> (RPL - CPL) variando
          <strong>% Penny</strong> e <strong>Convers√£o Full do controle</strong>. Mant√©m split dos planos e uplift do comprador.
        </p>
      </div>

      <div class="bg-white rounded-2xl border border-slate-200 overflow-hidden">
        <div class="p-4 border-b border-slate-200 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
          <div class="text-sm text-slate-700 font-semibold">M√©trica exibida</div>
          <div class="flex items-center gap-3 text-sm">
            <button id="btnHeatRPL" class="px-3 py-2 rounded-lg bg-slate-900 text-white">RPL</button>
            <button id="btnHeatMargin" class="px-3 py-2 rounded-lg bg-white border border-slate-300 text-slate-700">Margem/Lead</button>
          </div>
        </div>
        <div class="p-4 overflow-auto">
          <div id="heatmapContainer" class="min-w-[900px]"></div>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6 text-xs text-slate-600">
        <div class="bg-white border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="font-semibold text-slate-700 mb-1">Como usar</div>
          <div>1) Ajuste premissas no painel.</div>
          <div>2) Veja onde RPL passa o CPL com folga.</div>
        </div>
        <div class="bg-white border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="font-semibold text-slate-700 mb-1">Leitura</div>
          <div>C√©lulas mais ‚Äúescuras‚Äù = mais valor (RPL/margem maior).</div>
        </div>
        <div class="bg-white border border-slate-200 rounded-xl p-4 min-w-0">
          <div class="font-semibold text-slate-700 mb-1">Decis√£o</div>
          <div>Se a margem apertar: subir %penny, aumentar uplift, ou melhorar conv full no controle.</div>
        </div>
      </div>
    </section>

    <!-- ENTREG√ÅVEIS -->
    <section class="bg-brand-dark rounded-3xl p-8 md:p-12 text-white">
      <div class="text-center mb-10">
        <h2 class="text-3xl font-bold mb-4">O Que Vamos Entregar?</h2>
        <p class="text-indigo-200 max-w-2xl mx-auto">
          A oferta precisa ser no-brainer e complementar √† imers√£o, sem concorrer com a assinatura principal.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
        <div class="bg-indigo-900/50 border border-indigo-700 rounded-2xl p-8 hover:bg-indigo-800 transition duration-300">
          <div class="flex justify-between items-start mb-6">
            <div>
              <h3 class="text-xl font-bold text-white">Plano Essencial</h3>
              <div class="text-indigo-300 text-sm mt-1">Entrada</div>
            </div>
            <div class="text-3xl font-bold text-white">R$ 5</div>
          </div>
          <ul class="space-y-3 mb-8">
            <li class="flex items-center text-indigo-100"><span class="mr-2 text-brand-secondary">‚úì</span> Ebook Oficial da Imers√£o</li>
            <li class="flex items-center text-indigo-100"><span class="mr-2 text-brand-secondary">‚úì</span> 1 V√≠deo Exclusivo Complementar</li>
            <li class="flex items-center text-indigo-400 opacity-60"><span class="mr-2">‚úï</span> Materiais B√¥nus</li>
          </ul>
          <button class="w-full py-3 rounded-lg bg-indigo-600 text-white font-semibold text-sm opacity-80 cursor-default">
            Op√ß√£o de Entrada
          </button>
        </div>

        <div class="bg-white text-slate-900 rounded-2xl p-8 relative shadow-2xl transform md:-translate-y-4">
          <div class="absolute top-0 right-0 bg-brand-accent text-white text-xs font-bold px-3 py-1 rounded-bl-lg rounded-tr-lg">MELHOR VALOR</div>
          <div class="flex justify-between items-start mb-6">
            <div>
              <h3 class="text-xl font-bold text-brand-primary">Plano Pro</h3>
              <div class="text-slate-500 text-sm mt-1">Recomendado</div>
            </div>
            <div class="text-3xl font-bold text-brand-dark">R$ 17</div>
          </div>
          <ul class="space-y-3 mb-8">
            <li class="flex items-center text-slate-700"><span class="mr-2 text-brand-secondary font-bold">‚úì</span> Ebook Oficial da Imers√£o</li>
            <li class="flex items-center text-slate-700"><span class="mr-2 text-brand-secondary font-bold">‚úì</span> <strong class="ml-1">3 V√≠deos</strong> Exclusivos</li>
            <li class="flex items-center text-slate-700"><span class="mr-2 text-brand-secondary font-bold">‚úì</span> Pack de Materiais B√¥nus</li>
            <li class="flex items-center text-slate-700"><span class="mr-2 text-brand-secondary font-bold">‚úì</span> Destaque na Comunidade</li>
          </ul>
          <button class="w-full py-3 rounded-lg bg-brand-primary text-white font-semibold text-sm shadow-lg hover:bg-brand-dark transition">
            Oferta Principal
          </button>
        </div>
      </div>
    </section>

    <!-- EXPERIMENTO -->
    <section class="py-16 border-t border-slate-200">
      <div class="max-w-5xl mx-auto">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-slate-900 mb-3">Desenho do Experimento</h2>
          <p class="text-slate-500 text-sm max-w-2xl mx-auto">
            Split 50/50 com controle absoluto para validar impacto do Penny Product com clareza.
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center relative">
          <div class="text-center relative step-connector p-6">
            <div class="w-14 h-14 bg-slate-200 rounded-full flex items-center justify-center text-xl mx-auto mb-4">üë•</div>
            <h4 class="font-bold text-slate-800">Inscritos</h4>
            <p class="text-xs text-slate-500 mt-1">Base total (100%)</p>
          </div>

          <div class="text-center relative step-connector p-6">
            <div class="w-14 h-14 bg-slate-100 border-2 border-dashed border-slate-300 rounded-full flex items-center justify-center text-xl mx-auto mb-4">üì≠</div>
            <h4 class="font-bold text-slate-700">Grupo Controle (50%)</h4>
            <p class="text-xs text-slate-500 mt-2">Sem popup na TYP<br />Fluxo padr√£o da imers√£o</p>
          </div>

          <div class="text-center relative last-step p-6">
            <div class="w-14 h-14 bg-brand-primary text-white rounded-full flex items-center justify-center text-xl mx-auto mb-4 shadow-md">‚ö°</div>
            <h4 class="font-bold text-brand-primary">Grupo Tratamento (50%)</h4>
            <p class="text-xs text-slate-500 mt-2">Popup TYP (R$5 vs R$17)<br />Segmenta√ß√£o autom√°tica</p>

            <div class="mt-6 bg-slate-50 border border-slate-200 rounded-xl p-4">
              <div class="text-xs font-semibold text-slate-700 uppercase mb-1">Camada adicional</div>
              <p class="text-[11px] text-slate-500">
                Split interno 50/50 para envio de oferta complementar via e-mail p√≥s-pesquisa.
              </p>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mt-16">
          <div class="text-center p-4 bg-white border border-slate-200 rounded-xl shadow-sm">
            <div class="text-xs text-slate-500 uppercase mb-2">Dura√ß√£o</div>
            <div class="text-sm font-bold text-slate-800">Full Cohort</div>
          </div>
          <div class="text-center p-4 bg-white border border-slate-200 rounded-xl shadow-sm">
            <div class="text-xs text-slate-500 uppercase mb-2">Metodologia</div>
            <div class="text-sm font-bold text-slate-800">A/B Split 50/50</div>
          </div>
          <div class="text-center p-4 bg-white border border-slate-200 rounded-xl shadow-sm">
            <div class="text-xs text-slate-500 uppercase mb-2">Risco</div>
            <div class="text-sm font-bold text-green-600 uppercase">Baixo</div>
          </div>
          <div class="text-center p-4 bg-white border border-slate-200 rounded-xl shadow-sm">
            <div class="text-xs text-slate-500 uppercase mb-2">Status</div>
            <div class="text-sm font-bold text-brand-primary uppercase">Aprova√ß√£o</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Conclus√£o -->
    <footer class="text-center py-12 border-t border-slate-200 mt-12">
      <h2 class="text-2xl font-bold text-slate-800 mb-4">Foco em previsibilidade</h2>
      <p class="max-w-3xl mx-auto text-slate-600 mb-8">
        Vamos construir previsibilidade. Ao aumentar a convers√£o do Full via qualifica√ß√£o financeira,
        elevamos RPL, reduzimos CAC l√≠quido e abrimos espa√ßo para escalar m√≠dia com menos risco.
      </p>
      <div class="inline-flex items-center space-x-2 text-sm text-slate-400">
        <span>Time de Product Marketing</span>
        <span>‚Ä¢</span>
        <span>Alura</span>
        <span>‚Ä¢</span>
        <span>Fev 2025</span>
      </div>
    </footer>

  </main>

  <!-- SCRIPTS -->
  <script>
    // ===== Helpers =====
    function asNumber(id) {
      const el = document.getElementById(id);
      if (!el) return 0;
      const v = (el.value || "").toString().replace(",", ".");
      return Number(v) || 0;
    }
    function pctToDec(pct) { return (pct || 0) / 100; }
    function clamp01(x) { return Math.max(0, Math.min(1, x)); }
    function formatBRL(n) {
      return (n || 0).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    }

    // ===== Model (L1/L2/L3) =====
    function computeModel(params) {
      const base = Math.max(1, params.base);
      const cpl = Math.max(0, params.cpl);
      const fixed = Math.max(0, params.fixed);
      const fullTicket = Math.max(0, params.fullTicket);

      const pennyConv = clamp01(params.pennyConv); // decimal
      const split5 = clamp01(params.split5);       // decimal
      const split17 = 1 - split5;

      const fullCtrl = clamp01(params.fullCtrl);   // decimal
      const buyerUplift = Math.max(1, params.buyerUplift); // x
      const fullBuyer = clamp01(fullCtrl * buyerUplift);

      // Buyers (penny)
      const buyersTotal = base * pennyConv;
      const buyers5 = buyersTotal * split5;
      const buyers17 = buyersTotal * split17;

      // L1: Penny revenue
      const revenuePenny = buyers5 * 5 + buyers17 * 17;
      const rplPenny = revenuePenny / base;

      // Full revenue: clusters
      const nonBuyers = base - buyersTotal;

      const salesCtrl = nonBuyers * fullCtrl;
      const salesBuyers = buyersTotal * fullBuyer;

      const revenueFull = (salesCtrl + salesBuyers) * fullTicket;

      const totalRevenue = revenuePenny + revenueFull;
      const rpl = totalRevenue / base;

      // Baseline (sem penny)
      const revenueCurrent = (base * fullCtrl) * fullTicket;
      const rplCurrent = revenueCurrent / base;

      // Increment
      const deltaRevenue = totalRevenue - revenueCurrent;
      const deltaPct = revenueCurrent > 0 ? (deltaRevenue / revenueCurrent) : 0;
      const deltaRPL = rpl - rplCurrent;

      // L3 proxies
      const fixedPerLead = fixed / base;

      // CPL j√° inclui m√≠dia/lead.
      const netCAC = cpl - rplPenny;

      // "Teto CPA" proxy
      const cpaMaxProxy = rpl - fixedPerLead;

      // Break-even estrutural
      const beLeads = rpl > 0 ? (fixed / rpl) : Infinity;

      return {
        base, cpl, fixed, fullTicket,
        pennyConv, split5, split17, fullCtrl, buyerUplift, fullBuyer,
        buyersTotal, buyers5, buyers17,
        revenuePenny, revenueFull, totalRevenue,
        revenueCurrent, rpl, rplCurrent,
        deltaRevenue, deltaPct, deltaRPL,
        rplPenny,
        netCAC,
        fixedPerLead,
        cpaMaxProxy,
        beLeads,
        salesCtrl, salesBuyers
      };
    }

    // ===== Charts =====
    Chart.defaults.font.family = "'Inter', sans-serif";
    Chart.defaults.color = '#64748b';
    Chart.defaults.scale.grid.color = '#e2e8f0';
    Chart.defaults.plugins.legend.labels.usePointStyle = true;

    let mixBuyersChart, revenueSplitChart;
    let heatMode = 'rpl'; // 'rpl' | 'margin'

    function upsertCharts(model) {
      // Mix buyers
      const ctxMix = document.getElementById('mixBuyersChart')?.getContext('2d');
      if (ctxMix) {
        const dataMix = [model.buyers5, model.buyers17];
        if (!mixBuyersChart) {
          mixBuyersChart = new Chart(ctxMix, {
            type: 'doughnut',
            data: {
              labels: ['Compradores R$ 5', 'Compradores R$ 17'],
              datasets: [{ data: dataMix, backgroundColor: ['#4338ca', '#0d9488'], borderWidth: 0, hoverOffset: 4 }]
            },
            options: { responsive: true, maintainAspectRatio: false, cutout: '65%', plugins: { legend: { position: 'bottom' } } }
          });
        } else {
          mixBuyersChart.data.datasets[0].data = dataMix;
          mixBuyersChart.update();
        }
      }

      // Revenue split
      const ctxRev = document.getElementById('revenueSplitChart')?.getContext('2d');
      if (ctxRev) {
        const penny = model.revenuePenny;
        const full = model.revenueFull;

        if (!revenueSplitChart) {
          revenueSplitChart = new Chart(ctxRev, {
            type: 'bar',
            data: {
              labels: ['Receita Total'],
              datasets: [
                { label: 'Penny (L1)', data: [penny], backgroundColor: '#f59e0b', borderRadius: 8 },
                { label: 'Full (L2)', data: [full], backgroundColor: '#0d9488', borderRadius: 8 }
              ]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { position: 'top' },
                tooltip: { callbacks: { label: (ctx) => `${ctx.dataset.label}: ${formatBRL(ctx.parsed.y)}` } }
              },
              scales: {
                x: { stacked: true },
                y: { stacked: true, beginAtZero: true, ticks: { callback: (v) => 'R$ ' + (v/1000).toFixed(0) + 'k' } }
              }
            }
          });
        } else {
          revenueSplitChart.data.datasets[0].data = [penny];
          revenueSplitChart.data.datasets[1].data = [full];
          revenueSplitChart.update();
        }
      }
    }

    // ===== KPIs =====
    function upsertKpis(model) {
      const elTotal = document.getElementById('kpiTotalRevenue');
      const elTotalNote = document.getElementById('kpiTotalRevenueNote');
      const elRPL = document.getElementById('kpiRPL');
      const elRPLNote = document.getElementById('kpiRPLNote');

      const elNetCAC = document.getElementById('kpiNetCAC');
      const elNetCACNote = document.getElementById('kpiNetCACNote');

      const elInc = document.getElementById('kpiIncrement');
      const elIncNote = document.getElementById('kpiIncrementNote');

      const elCPAMax = document.getElementById('kpiCPAMax');
      const elCPAMaxNote = document.getElementById('kpiCPAMaxNote');

      if (elTotal) elTotal.textContent = formatBRL(model.totalRevenue);
      if (elTotalNote) elTotalNote.textContent = `Penny (L1): ${formatBRL(model.revenuePenny)} ‚Ä¢ Full (L2): ${formatBRL(model.revenueFull)}`;

      if (elRPL) elRPL.textContent = formatBRL(model.rpl);
      if (elRPLNote) elRPLNote.textContent = `RPL atual: ${formatBRL(model.rplCurrent)} ‚Ä¢ ŒîRPL: ${formatBRL(model.deltaRPL)}`;

      if (elNetCAC) elNetCAC.textContent = formatBRL(model.netCAC);
      if (elNetCACNote) elNetCACNote.textContent = `CPL: ${formatBRL(model.cpl)} ‚Ä¢ RPL Penny: ${formatBRL(model.rplPenny)} (CPL ‚àí RPLpenny)`;

      if (elInc) elInc.textContent = formatBRL(model.deltaRevenue);
      if (elIncNote) elIncNote.textContent = `Incremento: ${(model.deltaPct * 100).toFixed(0)}% ‚Ä¢ Uplift: ${model.buyerUplift.toFixed(1)}√ó`;

      if (elCPAMax) elCPAMax.textContent = formatBRL(model.cpaMaxProxy);
      if (elCPAMaxNote) elCPAMaxNote.textContent = `Custo fixo/lead: ${formatBRL(model.fixedPerLead)} ‚Ä¢ BE estrutural: ${Math.ceil(model.beLeads).toLocaleString('pt-BR')} leads`;

      const e1 = document.getElementById('execL1');
      const e2 = document.getElementById('execL2');
      const e3 = document.getElementById('execL3');

      if (e1) e1.textContent = `RPL Penny: ${formatBRL(model.rplPenny)} ‚Üí CAC l√≠quido: ${formatBRL(model.netCAC)}`;
      if (e2) e2.textContent = `Conv Full (controle): ${(model.fullCtrl*100).toFixed(2)}% ‚Ä¢ Comprador: ${(model.fullBuyer*100).toFixed(2)}%`;
      if (e3) e3.textContent = `Teto (proxy): ${formatBRL(model.cpaMaxProxy)} por lead (j√° abatendo fixo/lead)`;
    }

    // ===== Heatmap =====
    function buildHeatmap(baseParams) {
      const xs = [0.8, 1.0, 1.7, 2, 3, 4, 5, 6, 7, 8].map(pctToDec);
      const ys = [2, 3, 4, 5, 6].map(pctToDec);

      const values = [];
      ys.forEach(y => xs.forEach(x => {
        const p = { ...baseParams, pennyConv: y, fullCtrl: x };
        const m = computeModel(p);
        const v = (heatMode === 'rpl') ? m.rpl : (m.rpl - m.cpl);
        values.push(v);
      }));

      const minV = Math.min(...values);
      const maxV = Math.max(...values);
      const span = (maxV - minV) || 1;

      function cellBg(v) {
        const t = clamp01((v - minV) / span);
        const alpha = 0.08 + t * 0.35;
        return `rgba(13, 148, 136, ${alpha})`;
      }

      let html = `
        <table class="w-full text-sm border-collapse">
          <thead>
            <tr>
              <th class="text-left p-3 border-b border-slate-200 bg-slate-50 sticky left-0 z-10">Penny \\ Full</th>
              ${xs.map(x => `<th class="p-3 border-b border-slate-200 bg-slate-50 text-center">${(x*100).toFixed(1)}%</th>`).join('')}
            </tr>
          </thead>
          <tbody>
            ${ys.map(y => {
              return `
                <tr>
                  <td class="p-3 border-b border-slate-100 bg-white sticky left-0 z-10 font-semibold text-slate-700">
                    ${(y*100).toFixed(0)}%
                  </td>
                  ${xs.map(x => {
                    const p = { ...baseParams, pennyConv: y, fullCtrl: x };
                    const m = computeModel(p);
                    const margin = (m.rpl - m.cpl);
                    const v = (heatMode === 'rpl') ? m.rpl : margin;

                    const label = formatBRL(v);
                    const sub = (heatMode === 'rpl')
                      ? `Margem: ${formatBRL(margin)}`
                      : `RPL: ${formatBRL(m.rpl)}`;

                    return `
                      <td class="p-3 border-b border-slate-100 text-center" style="background:${cellBg(v)}">
                        <div class="font-bold text-slate-900">${label}</div>
                        <div class="text-xs text-slate-600 mt-1">${sub}</div>
                      </td>
                    `;
                  }).join('')}
                </tr>
              `;
            }).join('')}
          </tbody>
        </table>
      `;

      const container = document.getElementById('heatmapContainer');
      if (container) container.innerHTML = html;
    }

    // ===== Orchestration =====
    function getParamsFromInputs() {
      const base = asNumber('inpBase');
      const cpl = asNumber('inpCPL');
      const fixed = asNumber('inpFixed');
      const fullTicket = asNumber('inpFullTicket');

      const pennyConv = pctToDec(asNumber('inpPennyConv'));
      const split5 = pctToDec(asNumber('inpSplit5'));

      const fullCtrl = pctToDec(asNumber('inpFullCtrl'));
      const buyerUplift = asNumber('inpBuyerUplift');

      return {
        base,
        cpl,
        fixed,
        fullTicket,
        pennyConv,
        split5: clamp01(split5),
        fullCtrl: clamp01(fullCtrl),
        buyerUplift
      };
    }

    function refreshAll() {
      const params = getParamsFromInputs();
      const model = computeModel(params);
      upsertKpis(model);
      upsertCharts(model);
      buildHeatmap(params);
    }

    function bindInputs() {
      const ids = [
        'inpBase','inpCPL','inpFixed','inpFullTicket',
        'inpPennyConv','inpSplit5','inpFullCtrl','inpBuyerUplift'
      ];
      ids.forEach(id => {
        const el = document.getElementById(id);
        if (!el) return;
        el.addEventListener('input', refreshAll);
      });

      const btnRPL = document.getElementById('btnHeatRPL');
      const btnMargin = document.getElementById('btnHeatMargin');

      if (btnRPL && btnMargin) {
        btnRPL.addEventListener('click', () => {
          heatMode = 'rpl';
          btnRPL.className = 'px-3 py-2 rounded-lg bg-slate-900 text-white';
          btnMargin.className = 'px-3 py-2 rounded-lg bg-white border border-slate-300 text-slate-700';
          refreshAll();
        });

        btnMargin.addEventListener('click', () => {
          heatMode = 'margin';
          btnMargin.className = 'px-3 py-2 rounded-lg bg-slate-900 text-white';
          btnRPL.className = 'px-3 py-2 rounded-lg bg-white border border-slate-300 text-slate-700';
          refreshAll();
        });
      }
    }

    bindInputs();
    refreshAll();
  </script>

</body>
</html>
